# Qdrant æµ‹è¯•è„šæœ¬è¯´æ˜

æœ¬ç›®å½•åŒ…å«äº†å¤šä¸ªQdrantè¿æ¥å’ŒåŠŸèƒ½æµ‹è¯•è„šæœ¬ï¼Œç”¨äºéªŒè¯QdrantæœåŠ¡çš„å¯ç”¨æ€§å’ŒåŠŸèƒ½å®Œæ•´æ€§ã€‚

> ğŸ“¡ **è¿æ¥æ–¹å¼**: æœ¬é¡¹ç›®é»˜è®¤ä½¿ç”¨ **gRPC (ç«¯å£6334)** è¿æ¥Qdrantï¼Œæä¾›æ›´é«˜çš„æ€§èƒ½å’Œæ›´ä½çš„å»¶è¿Ÿã€‚

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

æœ¬é¡¹ç›®ä½¿ç”¨ [uv](https://docs.astral.sh/uv/) ä½œä¸ºPythonåŒ…ç®¡ç†å™¨å’Œè¿è¡Œå·¥å…·ã€‚

### å®‰è£… uv
```bash
# macOS å’Œ Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# æˆ–ä½¿ç”¨ pip å®‰è£…
pip install uv
```

### éªŒè¯å®‰è£…
```bash
uv --version
```

### é¡¹ç›®ä¾èµ–
è¿è¡Œæµ‹è¯•è„šæœ¬å‰ï¼Œuvä¼šè‡ªåŠ¨å®‰è£…æ‰€éœ€ä¾èµ–ï¼ŒåŒ…æ‹¬ï¼š
- `qdrant-client`: Qdrant Pythonå®¢æˆ·ç«¯ï¼ˆæ”¯æŒgRPCè¿æ¥ï¼‰
- `numpy`: æ•°å€¼è®¡ç®—åº“

### Qdrantè¿æ¥é…ç½®
é¡¹ç›®é»˜è®¤ä½¿ç”¨gRPCè¿æ¥æ–¹å¼ï¼š
- **ç«¯å£**: 6334 (gRPC)
- **åè®®**: gRPC (é«˜æ€§èƒ½äºŒè¿›åˆ¶åè®®)
- **é…ç½®**: `QDRANT_URL=localhost:6334` å’Œ `QDRANT_USE_GRPC=true`

### uv çš„ä¼˜åŠ¿
- âš¡ **å¿«é€Ÿ**: æ¯”pipå¿«10-100å€çš„ä¾èµ–è§£æå’Œå®‰è£…
- ğŸ”’ **å¯é **: è‡ªåŠ¨ç®¡ç†è™šæ‹Ÿç¯å¢ƒå’Œä¾èµ–ç‰ˆæœ¬
- ğŸ¯ **ç®€å•**: æ— éœ€æ‰‹åŠ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œä¸€æ¡å‘½ä»¤å³å¯è¿è¡Œ
- ğŸ”„ **ä¸€è‡´**: ç¡®ä¿æ‰€æœ‰å¼€å‘è€…ä½¿ç”¨ç›¸åŒçš„ä¾èµ–ç‰ˆæœ¬

### gRPC è¿æ¥çš„ä¼˜åŠ¿
- ğŸš€ **é«˜æ€§èƒ½**: äºŒè¿›åˆ¶åè®®ï¼Œæ¯”HTTP RESTæ›´å¿«
- ğŸ“¦ **ä½å»¶è¿Ÿ**: å‡å°‘ç½‘ç»œå¼€é”€å’Œåºåˆ—åŒ–æ—¶é—´
- ğŸ”„ **æµå¼ä¼ è¾“**: æ”¯æŒåŒå‘æµå’Œé•¿è¿æ¥
- ğŸ’ª **ç±»å‹å®‰å…¨**: å¼ºç±»å‹æ¥å£å®šä¹‰

## ğŸ“‹ æµ‹è¯•è„šæœ¬æ¦‚è§ˆ

### 1. `qdrant_quick_test.py` - å¿«é€Ÿè¿æ¥æµ‹è¯•
**ç”¨é€”**: å¿«é€Ÿæ£€æŸ¥6333å’Œ6334ç«¯å£çš„è¿æ¥çŠ¶æ€
**ç‰¹ç‚¹**: 
- ç®€å•å¿«é€Ÿ
- æµ‹è¯•gRPC (6334) å’Œ HTTP (6333) ç«¯å£è¿é€šæ€§
- éªŒè¯åŸºæœ¬APIè°ƒç”¨
- é€‚åˆæ—¥å¸¸æ£€æŸ¥

**ä½¿ç”¨æ–¹æ³•**:
```bash
uv run examples/qdrant_quick_test.py
```

**è¾“å‡ºç¤ºä¾‹**:
```
ğŸš€ Qdrant å¿«é€Ÿè¿æ¥æµ‹è¯•
========================================
ç›®æ ‡ä¸»æœº: localhost

ğŸ“¡ gRPC è¿æ¥æµ‹è¯• (ç«¯å£ 6334)
------------------------------
ğŸ” æµ‹è¯• gRPC ç«¯å£ 6334... âœ… ç«¯å£å¯è®¿é—®
ğŸ”Œ æµ‹è¯• gRPC å®¢æˆ·ç«¯è¿æ¥... âœ… å®¢æˆ·ç«¯è¿æ¥æˆåŠŸ
ğŸ“‹ æµ‹è¯•è·å–é›†åˆåˆ—è¡¨... âœ… æˆåŠŸ (å½“å‰æœ‰ 0 ä¸ªé›†åˆ)

ğŸ“¡ HTTP è¿æ¥æµ‹è¯• (ç«¯å£ 6333)
------------------------------
ğŸ” æµ‹è¯• HTTP ç«¯å£ 6333... âœ… ç«¯å£å¯è®¿é—®
ğŸ”Œ æµ‹è¯• HTTP å®¢æˆ·ç«¯è¿æ¥... âœ… å®¢æˆ·ç«¯è¿æ¥æˆåŠŸ
ğŸ“‹ æµ‹è¯•è·å–é›†åˆåˆ—è¡¨... âœ… æˆåŠŸ (å½“å‰æœ‰ 0 ä¸ªé›†åˆ)

ğŸ“‹ æµ‹è¯•æ€»ç»“
========================================
gRPC (6334):  âœ… å®Œå…¨å¯ç”¨ (å½“å‰ä½¿ç”¨)
HTTP (6333):  âœ… å®Œå…¨å¯ç”¨ (å¤‡ç”¨)

ğŸ‰ gRPCè¿æ¥å¯ç”¨ï¼
ğŸ’¡ å½“å‰é…ç½®: ä½¿ç”¨é«˜æ€§èƒ½gRPCè¿æ¥ (ç«¯å£6334)
```

### 2. `qdrant_connection_test.py` - ç»¼åˆè¿æ¥æµ‹è¯•
**ç”¨é€”**: å…¨é¢æµ‹è¯•Qdrantè¿æ¥å’ŒåŸºæœ¬æ“ä½œ
**ç‰¹ç‚¹**:
- è¯¦ç»†çš„è¿æ¥æµ‹è¯•
- å®Œæ•´çš„CRUDæ“ä½œéªŒè¯
- æ”¯æŒè‡ªå®šä¹‰ä¸»æœºå’Œç«¯å£
- è¯¦ç»†çš„é”™è¯¯æŠ¥å‘Š

**ä½¿ç”¨æ–¹æ³•**:
```bash
# é»˜è®¤æµ‹è¯•
uv run examples/qdrant_connection_test.py

# è‡ªå®šä¹‰ä¸»æœºå’Œç«¯å£
uv run examples/qdrant_connection_test.py --host 192.168.1.100 --http-port 6333 --grpc-port 6334
```

**æµ‹è¯•å†…å®¹**:
- ç«¯å£è¿é€šæ€§æ£€æŸ¥
- å®¢æˆ·ç«¯åˆ›å»ºå’Œè¿æ¥
- è·å–é›†åˆåˆ—è¡¨
- åˆ›å»ºæµ‹è¯•é›†åˆ
- æ’å…¥å‘é‡ç‚¹
- æ‰§è¡Œå‘é‡æœç´¢
- åˆ é™¤é›†åˆ

### 3. `qdrant_collection_test.py` - é›†åˆæ“ä½œæµ‹è¯•
**ç”¨é€”**: ä¸“é—¨æµ‹è¯•Qdrantçš„é›†åˆç®¡ç†å’Œå‘é‡æ“ä½œåŠŸèƒ½
**ç‰¹ç‚¹**:
- åŸºæœ¬é›†åˆæ“ä½œæµ‹è¯•
- å‘é‡æ’å…¥å’Œæœç´¢æµ‹è¯•
- é«˜çº§åŠŸèƒ½æµ‹è¯•ï¼ˆæ‰¹é‡æ“ä½œã€å¤æ‚è¿‡æ»¤ç­‰ï¼‰
- è‡ªåŠ¨æ¸…ç†æµ‹è¯•æ•°æ®

**ä½¿ç”¨æ–¹æ³•**:
```bash
# é»˜è®¤æµ‹è¯•
uv run examples/qdrant_collection_test.py

# è‡ªå®šä¹‰è¿æ¥
uv run examples/qdrant_collection_test.py --host localhost --port 6333
```

**æµ‹è¯•å†…å®¹**:
- **åŸºæœ¬æ“ä½œ**: åˆ›å»ºé›†åˆã€è·å–ä¿¡æ¯ã€åˆ—å‡ºé›†åˆ
- **å‘é‡æ“ä½œ**: æ’å…¥å‘é‡ã€å‘é‡æœç´¢ã€è¿‡æ»¤æœç´¢
- **é«˜çº§æ“ä½œ**: æ‰¹é‡æ’å…¥ã€å¤æ‚è¿‡æ»¤ã€ç‚¹æ›´æ–°ã€ç‚¹åˆ é™¤

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºæœ¬ä½¿ç”¨
```bash
# å¿«é€Ÿæ£€æŸ¥è¿æ¥
uv run examples/qdrant_quick_test.py

# å…¨é¢è¿æ¥æµ‹è¯•
uv run examples/qdrant_connection_test.py

# é›†åˆåŠŸèƒ½æµ‹è¯•
uv run examples/qdrant_collection_test.py
```

> ğŸ’¡ **æç¤º**: `uv run` ä¼šè‡ªåŠ¨ï¼š
> - åˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿç¯å¢ƒ
> - å®‰è£…é¡¹ç›®ä¾èµ–
> - è¿è¡ŒæŒ‡å®šçš„Pythonè„šæœ¬
> 
> é¦–æ¬¡è¿è¡Œå¯èƒ½éœ€è¦å‡ ç§’é’Ÿæ¥å®‰è£…ä¾èµ–ï¼Œåç»­è¿è¡Œä¼šå¾ˆå¿«ã€‚

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: é¦–æ¬¡éƒ¨ç½²éªŒè¯
```bash
# 1. å¯åŠ¨QdrantæœåŠ¡
docker-compose -f docker-compose.vector.yml up -d qdrant

# 2. å¿«é€Ÿæ£€æŸ¥è¿æ¥
uv run examples/qdrant_quick_test.py

# 3. å¦‚æœè¿æ¥æ­£å¸¸ï¼Œè¿è¡Œå®Œæ•´æµ‹è¯•
uv run examples/qdrant_connection_test.py
```

### åœºæ™¯2: åŠŸèƒ½å®Œæ•´æ€§éªŒè¯
```bash
# è¿è¡Œé›†åˆæ“ä½œæµ‹è¯•
uv run examples/qdrant_collection_test.py
```

### åœºæ™¯3: æ•…éšœæ’é™¤
```bash
# 1. å¿«é€Ÿè¯Šæ–­
uv run examples/qdrant_quick_test.py

# 2. å¦‚æœæœ‰é—®é¢˜ï¼ŒæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
uv run examples/qdrant_connection_test.py
```

### åœºæ™¯4: æ€§èƒ½åŸºå‡†æµ‹è¯•
```bash
# è¿è¡Œé«˜çº§æ“ä½œæµ‹è¯•ï¼Œè§‚å¯Ÿæ€§èƒ½
uv run examples/qdrant_collection_test.py
```

## ğŸ“Š æµ‹è¯•ç»“æœè§£è¯»

### æˆåŠŸçŠ¶æ€
- âœ… **ç«¯å£å¯è®¿é—®**: ç½‘ç»œè¿æ¥æ­£å¸¸
- âœ… **å®¢æˆ·ç«¯è¿æ¥æˆåŠŸ**: QdrantæœåŠ¡å“åº”æ­£å¸¸
- âœ… **APIè°ƒç”¨æˆåŠŸ**: æœåŠ¡åŠŸèƒ½æ­£å¸¸
- âœ… **æ“ä½œå®Œæˆ**: å…·ä½“åŠŸèƒ½å·¥ä½œæ­£å¸¸

### å¤±è´¥çŠ¶æ€
- âŒ **ç«¯å£ä¸å¯è®¿é—®**: æœåŠ¡æœªå¯åŠ¨æˆ–ç½‘ç»œé—®é¢˜
- âŒ **å®¢æˆ·ç«¯è¿æ¥å¤±è´¥**: æœåŠ¡é…ç½®é—®é¢˜æˆ–ç‰ˆæœ¬ä¸å…¼å®¹
- âŒ **APIè°ƒç”¨å¤±è´¥**: æœåŠ¡å†…éƒ¨é”™è¯¯æˆ–æƒé™é—®é¢˜
- âŒ **æ“ä½œå¤±è´¥**: å…·ä½“åŠŸèƒ½å¼‚å¸¸

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1: ç«¯å£ä¸å¯è®¿é—®
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker ps | grep qdrant

# å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.vector.yml up -d qdrant

# æ£€æŸ¥gRPCç«¯å£ (ä¸»è¦)
netstat -an | grep 6334

# æ£€æŸ¥HTTPç«¯å£ (å¤‡ç”¨)
netstat -an | grep 6333
```

### é—®é¢˜2: gRPCå®¢æˆ·ç«¯è¿æ¥å¤±è´¥
- æ£€æŸ¥Qdrantç‰ˆæœ¬å…¼å®¹æ€§ï¼ˆç¡®ä¿æ”¯æŒgRPCï¼‰
- ç¡®è®¤gRPCç«¯å£6334æ˜¯å¦å¼€æ”¾
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢gRPCè¿æ¥
- éªŒè¯qdrant-clientç‰ˆæœ¬æ”¯æŒgRPC
- å¦‚æœgRPCæœ‰é—®é¢˜ï¼Œå¯ä¸´æ—¶åˆ‡æ¢åˆ°HTTPæ¨¡å¼

### é—®é¢˜3: APIè°ƒç”¨å¤±è´¥
- æ£€æŸ¥QdrantæœåŠ¡æ—¥å¿—
- ç¡®è®¤æœåŠ¡å®Œå…¨å¯åŠ¨ï¼ˆå¯èƒ½éœ€è¦ç­‰å¾…å‡ ç§’ï¼‰
- éªŒè¯å®¢æˆ·ç«¯åº“ç‰ˆæœ¬

### é—®é¢˜4: uvç›¸å…³é—®é¢˜
```bash
# æ¸…ç†uvç¼“å­˜
uv cache clean

# é‡æ–°å®‰è£…ä¾èµ–
uv sync --reinstall

# æŸ¥çœ‹uvç‰ˆæœ¬
uv --version

# æ‰‹åŠ¨å®‰è£…ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
uv add qdrant-client numpy
```

## ğŸ“ æµ‹è¯•è„šæœ¬ç‰¹ç‚¹å¯¹æ¯”

| è„šæœ¬ | é€Ÿåº¦ | è¯¦ç»†ç¨‹åº¦ | åŠŸèƒ½è¦†ç›– | é€‚ç”¨åœºæ™¯ |
|------|------|----------|----------|----------|
| `qdrant_quick_test.py` | å¿« | åŸºç¡€ | è¿æ¥æµ‹è¯• | æ—¥å¸¸æ£€æŸ¥ |
| `qdrant_connection_test.py` | ä¸­ | è¯¦ç»† | åŸºæœ¬æ“ä½œ | éƒ¨ç½²éªŒè¯ |
| `qdrant_collection_test.py` | æ…¢ | å…¨é¢ | å®Œæ•´åŠŸèƒ½ | åŠŸèƒ½æµ‹è¯• |

## ğŸ¯ å»ºè®®çš„æµ‹è¯•æµç¨‹

1. **å¼€å‘ç¯å¢ƒè®¾ç½®**:
   ```bash
   uv run examples/qdrant_quick_test.py
   ```

2. **éƒ¨ç½²åéªŒè¯**:
   ```bash
   uv run examples/qdrant_connection_test.py
   ```

3. **åŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥**:
   ```bash
   uv run examples/qdrant_collection_test.py
   ```

4. **å®šæœŸå¥åº·æ£€æŸ¥**:
   ```bash
   uv run examples/qdrant_quick_test.py
   ```

è¿™äº›æµ‹è¯•è„šæœ¬å¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿè¯Šæ–­å’ŒéªŒè¯QdrantæœåŠ¡çš„çŠ¶æ€ï¼Œç¡®ä¿å‘é‡æ•°æ®åº“åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚